(function webpackUniversalModuleDefinition(root, factory) {
	//Test Comment
	if(typeof exports === 'object' && typeof module === 'object')
		module.exports = factory();
	//Test Comment
	else if(typeof define === 'function' && define.amd)
		define([], factory);
	//Test Comment
	else if(typeof exports === 'object')
		exports["TQSDK"] = factory();
	//Test Comment
	else
		root["TQSDK"] = factory();
})(window, function() {
return /******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "./src/index.js");
/******/ })
/************************************************************************/
/******/ ({

/***/ "./node_modules/process/browser.js":
/*!*****************************************!*\
  !*** ./node_modules/process/browser.js ***!
  \*****************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("// shim for using process in browser\nvar process = module.exports = {}; // cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n  throw new Error('setTimeout has not been defined');\n}\n\nfunction defaultClearTimeout() {\n  throw new Error('clearTimeout has not been defined');\n}\n\n(function () {\n  try {\n    if (typeof setTimeout === 'function') {\n      cachedSetTimeout = setTimeout;\n    } else {\n      cachedSetTimeout = defaultSetTimout;\n    }\n  } catch (e) {\n    cachedSetTimeout = defaultSetTimout;\n  }\n\n  try {\n    if (typeof clearTimeout === 'function') {\n      cachedClearTimeout = clearTimeout;\n    } else {\n      cachedClearTimeout = defaultClearTimeout;\n    }\n  } catch (e) {\n    cachedClearTimeout = defaultClearTimeout;\n  }\n})();\n\nfunction runTimeout(fun) {\n  if (cachedSetTimeout === setTimeout) {\n    //normal enviroments in sane situations\n    return setTimeout(fun, 0);\n  } // if setTimeout wasn't available but was latter defined\n\n\n  if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n    cachedSetTimeout = setTimeout;\n    return setTimeout(fun, 0);\n  }\n\n  try {\n    // when when somebody has screwed with setTimeout but no I.E. maddness\n    return cachedSetTimeout(fun, 0);\n  } catch (e) {\n    try {\n      // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n      return cachedSetTimeout.call(null, fun, 0);\n    } catch (e) {\n      // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n      return cachedSetTimeout.call(this, fun, 0);\n    }\n  }\n}\n\nfunction runClearTimeout(marker) {\n  if (cachedClearTimeout === clearTimeout) {\n    //normal enviroments in sane situations\n    return clearTimeout(marker);\n  } // if clearTimeout wasn't available but was latter defined\n\n\n  if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n    cachedClearTimeout = clearTimeout;\n    return clearTimeout(marker);\n  }\n\n  try {\n    // when when somebody has screwed with setTimeout but no I.E. maddness\n    return cachedClearTimeout(marker);\n  } catch (e) {\n    try {\n      // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n      return cachedClearTimeout.call(null, marker);\n    } catch (e) {\n      // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n      // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n      return cachedClearTimeout.call(this, marker);\n    }\n  }\n}\n\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n  if (!draining || !currentQueue) {\n    return;\n  }\n\n  draining = false;\n\n  if (currentQueue.length) {\n    queue = currentQueue.concat(queue);\n  } else {\n    queueIndex = -1;\n  }\n\n  if (queue.length) {\n    drainQueue();\n  }\n}\n\nfunction drainQueue() {\n  if (draining) {\n    return;\n  }\n\n  var timeout = runTimeout(cleanUpNextTick);\n  draining = true;\n  var len = queue.length;\n\n  while (len) {\n    currentQueue = queue;\n    queue = [];\n\n    while (++queueIndex < len) {\n      if (currentQueue) {\n        currentQueue[queueIndex].run();\n      }\n    }\n\n    queueIndex = -1;\n    len = queue.length;\n  }\n\n  currentQueue = null;\n  draining = false;\n  runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n  var args = new Array(arguments.length - 1);\n\n  if (arguments.length > 1) {\n    for (var i = 1; i < arguments.length; i++) {\n      args[i - 1] = arguments[i];\n    }\n  }\n\n  queue.push(new Item(fun, args));\n\n  if (queue.length === 1 && !draining) {\n    runTimeout(drainQueue);\n  }\n}; // v8 likes predictible objects\n\n\nfunction Item(fun, array) {\n  this.fun = fun;\n  this.array = array;\n}\n\nItem.prototype.run = function () {\n  this.fun.apply(null, this.array);\n};\n\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\n\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) {\n  return [];\n};\n\nprocess.binding = function (name) {\n  throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () {\n  return '/';\n};\n\nprocess.chdir = function (dir) {\n  throw new Error('process.chdir is not supported');\n};\n\nprocess.umask = function () {\n  return 0;\n};\n\n//# sourceURL=webpack://TQSDK/./node_modules/process/browser.js?");

/***/ }),

/***/ "./node_modules/setimmediate/setImmediate.js":
/*!***************************************************!*\
  !*** ./node_modules/setimmediate/setImmediate.js ***!
  \***************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

eval("/* WEBPACK VAR INJECTION */(function(global, process) {(function (global, undefined) {\n  \"use strict\";\n\n  if (global.setImmediate) {\n    return;\n  }\n\n  var nextHandle = 1; // Spec says greater than zero\n\n  var tasksByHandle = {};\n  var currentlyRunningATask = false;\n  var doc = global.document;\n  var registerImmediate;\n\n  function setImmediate(callback) {\n    // Callback can either be a function or a string\n    if (typeof callback !== \"function\") {\n      callback = new Function(\"\" + callback);\n    } // Copy function arguments\n\n\n    var args = new Array(arguments.length - 1);\n\n    for (var i = 0; i < args.length; i++) {\n      args[i] = arguments[i + 1];\n    } // Store and register the task\n\n\n    var task = {\n      callback: callback,\n      args: args\n    };\n    tasksByHandle[nextHandle] = task;\n    registerImmediate(nextHandle);\n    return nextHandle++;\n  }\n\n  function clearImmediate(handle) {\n    delete tasksByHandle[handle];\n  }\n\n  function run(task) {\n    var callback = task.callback;\n    var args = task.args;\n\n    switch (args.length) {\n      case 0:\n        callback();\n        break;\n\n      case 1:\n        callback(args[0]);\n        break;\n\n      case 2:\n        callback(args[0], args[1]);\n        break;\n\n      case 3:\n        callback(args[0], args[1], args[2]);\n        break;\n\n      default:\n        callback.apply(undefined, args);\n        break;\n    }\n  }\n\n  function runIfPresent(handle) {\n    // From the spec: \"Wait until any invocations of this algorithm started before this one have completed.\"\n    // So if we're currently running a task, we'll need to delay this invocation.\n    if (currentlyRunningATask) {\n      // Delay by doing a setTimeout. setImmediate was tried instead, but in Firefox 7 it generated a\n      // \"too much recursion\" error.\n      setTimeout(runIfPresent, 0, handle);\n    } else {\n      var task = tasksByHandle[handle];\n\n      if (task) {\n        currentlyRunningATask = true;\n\n        try {\n          run(task);\n        } finally {\n          clearImmediate(handle);\n          currentlyRunningATask = false;\n        }\n      }\n    }\n  }\n\n  function installNextTickImplementation() {\n    registerImmediate = function registerImmediate(handle) {\n      process.nextTick(function () {\n        runIfPresent(handle);\n      });\n    };\n  }\n\n  function canUsePostMessage() {\n    // The test against `importScripts` prevents this implementation from being installed inside a web worker,\n    // where `global.postMessage` means something completely different and can't be used for this purpose.\n    if (global.postMessage && !global.importScripts) {\n      var postMessageIsAsynchronous = true;\n      var oldOnMessage = global.onmessage;\n\n      global.onmessage = function () {\n        postMessageIsAsynchronous = false;\n      };\n\n      global.postMessage(\"\", \"*\");\n      global.onmessage = oldOnMessage;\n      return postMessageIsAsynchronous;\n    }\n  }\n\n  function installPostMessageImplementation() {\n    // Installs an event handler on `global` for the `message` event: see\n    // * https://developer.mozilla.org/en/DOM/window.postMessage\n    // * http://www.whatwg.org/specs/web-apps/current-work/multipage/comms.html#crossDocumentMessages\n    var messagePrefix = \"setImmediate$\" + Math.random() + \"$\";\n\n    var onGlobalMessage = function onGlobalMessage(event) {\n      if (event.source === global && typeof event.data === \"string\" && event.data.indexOf(messagePrefix) === 0) {\n        runIfPresent(+event.data.slice(messagePrefix.length));\n      }\n    };\n\n    if (global.addEventListener) {\n      global.addEventListener(\"message\", onGlobalMessage, false);\n    } else {\n      global.attachEvent(\"onmessage\", onGlobalMessage);\n    }\n\n    registerImmediate = function registerImmediate(handle) {\n      global.postMessage(messagePrefix + handle, \"*\");\n    };\n  }\n\n  function installMessageChannelImplementation() {\n    var channel = new MessageChannel();\n\n    channel.port1.onmessage = function (event) {\n      var handle = event.data;\n      runIfPresent(handle);\n    };\n\n    registerImmediate = function registerImmediate(handle) {\n      channel.port2.postMessage(handle);\n    };\n  }\n\n  function installReadyStateChangeImplementation() {\n    var html = doc.documentElement;\n\n    registerImmediate = function registerImmediate(handle) {\n      // Create a <script> element; its readystatechange event will be fired asynchronously once it is inserted\n      // into the document. Do so, thus queuing up the task. Remember to clean up once it's been called.\n      var script = doc.createElement(\"script\");\n\n      script.onreadystatechange = function () {\n        runIfPresent(handle);\n        script.onreadystatechange = null;\n        html.removeChild(script);\n        script = null;\n      };\n\n      html.appendChild(script);\n    };\n  }\n\n  function installSetTimeoutImplementation() {\n    registerImmediate = function registerImmediate(handle) {\n      setTimeout(runIfPresent, 0, handle);\n    };\n  } // If supported, we should attach to the prototype of global, since that is where setTimeout et al. live.\n\n\n  var attachTo = Object.getPrototypeOf && Object.getPrototypeOf(global);\n  attachTo = attachTo && attachTo.setTimeout ? attachTo : global; // Don't get fooled by e.g. browserify environments.\n\n  if ({}.toString.call(global.process) === \"[object process]\") {\n    // For Node.js before 0.9\n    installNextTickImplementation();\n  } else if (canUsePostMessage()) {\n    // For non-IE10 modern browsers\n    installPostMessageImplementation();\n  } else if (global.MessageChannel) {\n    // For web workers, where supported\n    installMessageChannelImplementation();\n  } else if (doc && \"onreadystatechange\" in doc.createElement(\"script\")) {\n    // For IE 6–8\n    installReadyStateChangeImplementation();\n  } else {\n    // For older browsers\n    installSetTimeoutImplementation();\n  }\n\n  attachTo.setImmediate = setImmediate;\n  attachTo.clearImmediate = clearImmediate;\n})(typeof self === \"undefined\" ? typeof global === \"undefined\" ? this : global : self);\n/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../webpack/buildin/global.js */ \"./node_modules/webpack/buildin/global.js\"), __webpack_require__(/*! ./../process/browser.js */ \"./node_modules/process/browser.js\")))\n\n//# sourceURL=webpack://TQSDK/./node_modules/setimmediate/setImmediate.js?");

/***/ }),

/***/ "./node_modules/timers-browserify/main.js":
/*!************************************************!*\
  !*** ./node_modules/timers-browserify/main.js ***!
  \************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

eval("/* WEBPACK VAR INJECTION */(function(global) {var scope = typeof global !== \"undefined\" && global || typeof self !== \"undefined\" && self || window;\nvar apply = Function.prototype.apply; // DOM APIs, for completeness\n\nexports.setTimeout = function () {\n  return new Timeout(apply.call(setTimeout, scope, arguments), clearTimeout);\n};\n\nexports.setInterval = function () {\n  return new Timeout(apply.call(setInterval, scope, arguments), clearInterval);\n};\n\nexports.clearTimeout = exports.clearInterval = function (timeout) {\n  if (timeout) {\n    timeout.close();\n  }\n};\n\nfunction Timeout(id, clearFn) {\n  this._id = id;\n  this._clearFn = clearFn;\n}\n\nTimeout.prototype.unref = Timeout.prototype.ref = function () {};\n\nTimeout.prototype.close = function () {\n  this._clearFn.call(scope, this._id);\n}; // Does not start the time, just sets up the members needed.\n\n\nexports.enroll = function (item, msecs) {\n  clearTimeout(item._idleTimeoutId);\n  item._idleTimeout = msecs;\n};\n\nexports.unenroll = function (item) {\n  clearTimeout(item._idleTimeoutId);\n  item._idleTimeout = -1;\n};\n\nexports._unrefActive = exports.active = function (item) {\n  clearTimeout(item._idleTimeoutId);\n  var msecs = item._idleTimeout;\n\n  if (msecs >= 0) {\n    item._idleTimeoutId = setTimeout(function onTimeout() {\n      if (item._onTimeout) item._onTimeout();\n    }, msecs);\n  }\n}; // setimmediate attaches itself to the global object\n\n\n__webpack_require__(/*! setimmediate */ \"./node_modules/setimmediate/setImmediate.js\"); // On some exotic environments, it's not clear which object `setimmediate` was\n// able to install onto.  Search each possibility in the same order as the\n// `setimmediate` library.\n\n\nexports.setImmediate = typeof self !== \"undefined\" && self.setImmediate || typeof global !== \"undefined\" && global.setImmediate || this && this.setImmediate;\nexports.clearImmediate = typeof self !== \"undefined\" && self.clearImmediate || typeof global !== \"undefined\" && global.clearImmediate || this && this.clearImmediate;\n/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../webpack/buildin/global.js */ \"./node_modules/webpack/buildin/global.js\")))\n\n//# sourceURL=webpack://TQSDK/./node_modules/timers-browserify/main.js?");

/***/ }),

/***/ "./node_modules/webpack/buildin/global.js":
/*!***********************************!*\
  !*** (webpack)/buildin/global.js ***!
  \***********************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("function _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nvar g; // This works in non-strict mode\n\ng = function () {\n  return this;\n}();\n\ntry {\n  // This works if eval is allowed (see CSP)\n  g = g || new Function(\"return this\")();\n} catch (e) {\n  // This works if the window reference is available\n  if ((typeof window === \"undefined\" ? \"undefined\" : _typeof(window)) === \"object\") g = window;\n} // g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\n\nmodule.exports = g;\n\n//# sourceURL=webpack://TQSDK/(webpack)/buildin/global.js?");

/***/ }),

/***/ "./src/datamanage.js":
/*!***************************!*\
  !*** ./src/datamanage.js ***!
  \***************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _event__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./event */ \"./src/event.js\");\n/* harmony import */ var _datastructure__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./datastructure */ \"./src/datastructure.js\");\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./utils */ \"./src/utils.js\");\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _objectDestructuringEmpty(obj) { if (obj == null) throw new TypeError(\"Cannot destructure undefined\"); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\n\n\n\n\nvar MakeArrayProxy = function MakeArrayProxy(data_array, parent_target) {\n  var item_func = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : undefined;\n  return new Proxy(data_array, {\n    get: function get(target, prop, receiver) {\n      if (!isNaN(prop)) {\n        var i = Number(prop);\n        return i < 0 ? NaN : item_func ? item_func(target[i]) : target[i];\n      } else if (['last_id', 'trading_day_start_id', 'trading_day_end_id'].includes(prop)) {\n        return parent_target[prop];\n      } else {\n        return target[prop];\n      }\n    }\n  });\n};\n\nvar MergeObject = function MergeObject(target, source) {\n  var _epoch = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n\n  var deleteNullObj = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : true;\n\n  for (var property in source) {\n    var value = source[property];\n\n    switch (_typeof(value)) {\n      case 'object':\n        if (value === null) {\n          // 服务器 要求 删除对象\n          if (deleteNullObj && property) delete target[property];\n          continue;\n        } else if (Array.isArray(value) || property === 'data') {\n          // @note: 这里做了一个特例, 使得 K 线序列数据被保存为一个 array, 而非 object\n          if (!(property in target)) target[property] = [];\n        } else {\n          if (!(property in target)) target[property] = {};\n        }\n\n        if (property === 'quotes') {\n          // quotes 对象单独处理\n          for (var instrument_id in value) {\n            var instrument = value[instrument_id]; // source[property]\n\n            if (instrument === null) {\n              // 服务器 要求 删除对象\n              if (deleteNullObj && instrument_id) delete target[property][instrument_id];\n              continue;\n            } else if (!target[property][instrument_id]) {\n              target[property][instrument_id] = Object(_datastructure__WEBPACK_IMPORTED_MODULE_1__[\"default\"])('quote');\n            }\n\n            MergeObject(target[property][instrument_id], instrument, _epoch, deleteNullObj);\n          }\n        } else {\n          MergeObject(target[property], value, _epoch, deleteNullObj);\n        }\n\n        break;\n\n      case 'string':\n      case 'boolean':\n      case 'number':\n        target[property] = value === 'NaN' ? NaN : value;\n        break;\n\n      case 'undefined':\n        break;\n    }\n  } // _epoch 不应该被循环到的 key\n\n\n  if (!target['_epoch']) Object.defineProperty(target, '_epoch', {\n    configurable: false,\n    enumerable: false,\n    writable: true\n  });\n  target['_epoch'] = _epoch;\n};\n\nvar DataManager =\n/*#__PURE__*/\nfunction (_EventPrototype) {\n  _inherits(DataManager, _EventPrototype);\n\n  function DataManager() {\n    var _this;\n\n    var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    _objectDestructuringEmpty(_ref);\n\n    _classCallCheck(this, DataManager);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(DataManager).call(this));\n    _this._epoch = 0; // 数据版本控制\n\n    _this._data = {\n      quotes: {},\n      klines: {},\n      ticks: {},\n      charts: {}\n    };\n    return _this;\n  }\n\n  _createClass(DataManager, [{\n    key: \"getKlines\",\n    value: function getKlines(symbol, dur_nano) {\n      if (symbol === '') return null;\n\n      var ks = this._getByPath(['klines', symbol, dur_nano]);\n\n      if (!ks || !ks.data || ks.last_id === -1) {\n        MergeObject(this._data, {\n          klines: _defineProperty({}, symbol, _defineProperty({}, dur_nano, {\n            last_id: -1,\n            data: {}\n          }))\n        }, this._epoch - 1, false);\n      }\n\n      ks = this._getByPath(['klines', symbol, dur_nano]);\n\n      if (!ks.proxy) {\n        ks.proxy = MakeArrayProxy(ks.data, ks);\n        var arr = ['open', 'close', 'high', 'low', 'volume', 'close_oi', 'open_oi', 'datetime'];\n        arr.forEach(function (key) {\n          ks.data[key] = MakeArrayProxy(ks.data, ks, function (d) {\n            return d ? d[key] : NaN;\n          });\n        });\n      }\n\n      return ks.proxy;\n    }\n  }, {\n    key: \"getTicks\",\n    value: function getTicks(symbol) {\n      if (symbol === '') return null;\n\n      var ts = this._getByPath(['ticks', symbol]);\n\n      if (!ts || !ts.data) {\n        MergeObject(this._data, {\n          ticks: _defineProperty({}, symbol, {\n            last_id: -1,\n            data: {}\n          })\n        }, this._epoch - 1, false);\n      }\n\n      ts = this._getByPath(['ticks', symbol]);\n\n      if (!ts.proxy) {\n        ts.proxy = MakeArrayProxy(ts.data, ts);\n        var arr = ['last_price', 'average', 'highest', 'lowest', 'ask_price1', 'ask_volume1', 'bid_price1', 'bid_volume1', 'volume', 'amount', 'open_interest', 'datetime'];\n        arr.forEach(function (key) {\n          ts.data[key] = MakeArrayProxy(ts.data, ts, function (d) {\n            return d ? d[key] : NaN;\n          });\n        });\n      }\n\n      return ts.proxy;\n    }\n  }, {\n    key: \"setDefault\",\n    value: function setDefault(default_value) {\n      for (var _len = arguments.length, path = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        path[_key - 1] = arguments[_key];\n      }\n\n      var node = _typeof(path[0]) === 'object' ? path[0] : this._data;\n\n      for (var i = 0; i < path.length; i++) {\n        if (typeof path[i] === 'string' || typeof path[i] === 'number') {\n          if (!(path[i] in node)) {\n            if (i + 1 === path.length) {\n              var default_value_obj = typeof default_value === 'string' ? Object(_datastructure__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(default_value) : default_value;\n              node[path[i]] = default_value_obj;\n            } else {\n              node[path[i]] = {};\n            }\n          }\n\n          node = node[path[i]];\n        }\n      }\n\n      return node;\n    }\n  }, {\n    key: \"_getByPath\",\n    value: function _getByPath(_path) {\n      var path = Object(_utils__WEBPACK_IMPORTED_MODULE_2__[\"UnifyArrayStyle\"])(_path);\n      var d = this._data;\n      var i = 0;\n\n      for (; i < path.length; i++) {\n        d = d[path[i]];\n        if (d === undefined) break;\n      }\n\n      return i < path.length - 1 ? {} : d;\n    }\n  }, {\n    key: \"mergeData\",\n    value: function mergeData(source) {\n      var epochIncrease = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n      var deleteNullObj = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n      if (epochIncrease) this._epoch += 1;\n      var sourceArr = Array.isArray(source) ? source : [source];\n\n      for (var i in sourceArr) {\n        var item = sourceArr[i]; // 过滤掉空对象\n\n        if (!(item === null || Object(_utils__WEBPACK_IMPORTED_MODULE_2__[\"IsEmptyObject\"])(item))) {\n          MergeObject(this._data, item, this._epoch, deleteNullObj);\n        }\n      }\n\n      if (epochIncrease && this._data._epoch === this._epoch) {\n        this.fire('data', null);\n      }\n    }\n  }, {\n    key: \"isChanging\",\n    value: function isChanging(_path, source) {\n      var path = Object(_utils__WEBPACK_IMPORTED_MODULE_2__[\"UnifyArrayStyle\"])(_path); // _data 中，只能找到对象类型中记录的 _epoch\n\n      var d = this._data;\n\n      for (var i = 0; i < path.length; i++) {\n        d = d[path[i]];\n        if (d === undefined) return false;\n      }\n\n      if (_typeof(d) === 'object') {\n        return d._epoch && d._epoch === this._epoch ? true : false;\n      }\n\n      if (source) {\n        // 在 source 中找，找到能找到的数据\n        var _d = source;\n\n        for (var _i = 0; _i < path.length; _i++) {\n          _d = _d[path[_i]];\n          if (_d === undefined) return false;\n        }\n\n        return true;\n      }\n\n      return false;\n    }\n  }]);\n\n  return DataManager;\n}(_event__WEBPACK_IMPORTED_MODULE_0__[\"default\"]);\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (DataManager);\n\n//# sourceURL=webpack://TQSDK/./src/datamanage.js?");

/***/ }),

/***/ "./src/datastructure.js":
/*!******************************!*\
  !*** ./src/datastructure.js ***!
  \******************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\n/* eslint-disable vue/no-parsing-error */\nvar QUOTE =\n/*#__PURE__*/\nfunction () {\n  function QUOTE() {\n    _classCallCheck(this, QUOTE);\n\n    this.instrument_id = ''; // 'SHFE.au1906'\n\n    this.datetime = ''; // \"2017-07-26 23:04:21.000001\" (行情从交易所发出的时间(北京时间))\n\n    this._last_price = '-'; // 最新价 NaN\n\n    this.ask_price1 = '-'; // 卖一价 NaN\n\n    this.ask_volume1 = '-'; // 卖一量 0\n\n    this.bid_price1 = '-'; // 买一价 NaN\n\n    this.bid_volume1 = '-'; // 买一量 0\n\n    this.highest = '-'; // 当日最高价 NaN\n\n    this.lowest = '-'; // 当日最低价 NaN\n\n    this.open = '-'; // 开盘价 NaN\n\n    this.close = '-'; // 收盘价 NaN\n\n    this.average = '-'; // 当日均价 NaN\n\n    this.volume = '-'; // 成交量 0\n\n    this.amount = '-'; // 成交额 NaN\n\n    this.open_interest = '-'; // 持仓量 0\n\n    this.lower_limit = '-'; // 跌停 NaN\n\n    this.upper_limit = '-'; // 涨停 NaN\n\n    this.settlement = '-'; // 结算价 NaN\n\n    this.change = '-'; // 涨跌\n\n    this.change_percent = '-'; // 涨跌幅\n\n    this.strike_price = NaN; // 行权价\n\n    this.pre_open_interest = '-'; // 昨持仓量\n\n    this.pre_close = '-'; // 昨收盘价\n\n    this.pre_volume = '-'; // 昨成交量\n\n    this._pre_settlement = '-'; // 昨结算价\n\n    this.margin = '-'; // 每手保证金\n\n    this.commission = '-'; // 每手手续费\n    // 合约服务附带参数\n    // class: '', // ['FUTURE' 'FUTURE_INDEX' 'FUTURE_CONT']\n    // ins_id: '',\n    // ins_name: '',\n    // exchange_id: '',\n    // sort_key: '',\n    // expired: false,\n    // py: '',\n    // product_id: '',\n    // product_short_name: '',\n    // underlying_product: '',\n    // underlying_symbol: '', // 标的合约\n    // delivery_year: 0,\n    // delivery_month: 0,\n    // expire_datetime: 0,\n    // trading_time: {},\n    // volume_multiple: 0, // 合约乘数\n    // price_tick: 0, // 合约价格单位\n    // price_decs: 0, // 合约价格小数位数\n    // max_market_order_volume: 1000, // 市价单最大下单手数\n    // min_market_order_volume: 1, // 市价单最小下单手数\n    // max_limit_order_volume: 1000, // 限价单最大下单手数\n    // min_limit_order_volume: 1, // 限价单最小下单手数\n  }\n\n  _createClass(QUOTE, [{\n    key: \"setChange\",\n    value: function setChange() {\n      if (Number.isFinite(this._last_price) && Number.isFinite(this._pre_settlement) && this._pre_settlement != 0) {\n        this.change = this._last_price - this._pre_settlement;\n        this.change_percent = this.change / this._pre_settlement * 100;\n      }\n    }\n  }, {\n    key: \"last_price\",\n    set: function set(p) {\n      this._last_price = p;\n      this.setChange();\n    },\n    get: function get() {\n      return this._last_price;\n    }\n  }, {\n    key: \"pre_settlement\",\n    set: function set(p) {\n      this._pre_settlement = p;\n      this.setChange();\n    },\n    get: function get() {\n      return this._pre_settlement;\n    }\n  }]);\n\n  return QUOTE;\n}();\n\nvar KLINE = function KLINE() {\n  _classCallCheck(this, KLINE);\n\n  this.datetime = 0; // 1501080715000000000 (K线起点时间(按北京时间)，自unix epoch(1970-01-01 00:00:00 GMT)以来的纳秒数)\n\n  this.open = NaN; // K线起始时刻的最新价\n\n  this.close = NaN; // K线结束时刻的最新价\n\n  this.high = NaN; // K线时间范围内的最高价\n\n  this.low = NaN; // K线时间范围内的最低价\n\n  this.open_oi = 0; // K线起始时刻的持仓量\n\n  this.close_oi = 0; // K线结束时刻的持仓量\n\n  this.volume = 0; //K线时间范围内的成交量\n};\n\nvar TICK = function TICK() {\n  _classCallCheck(this, TICK);\n\n  this.datetime = 0; // 1501074872000000000 (tick从交易所发出的时间(按北京时间)，自unix epoch(1970-01-01 00:00:00 GMT)以来的纳秒数)\n\n  this.last_price = NaN; // 最新价\n\n  this.average = NaN; // 当日均价\n\n  this.highest = NaN; // 当日最高价\n\n  this.lowest = NaN; // 当日最低价\n\n  this.ask_price1 = NaN; // 卖一价\n\n  this.ask_volume1 = 0; // 卖一量\n\n  this.bid_price1 = NaN; // 买一价\n\n  this.bid_volume1 = 0; // 买一量\n\n  this.volume = 0; // 当日成交量\n\n  this.amount = NaN; // 成交额\n\n  this.open_interest = NaN; // 持仓量\n};\n\nvar TRADE = function TRADE() {\n  _classCallCheck(this, TRADE);\n\n  this.user_id = '';\n  this.order_id = ''; // 委托单ID, 对于一个用户的所有委托单，这个ID都是不重复的\n\n  this.trade_id = ''; // 成交ID, 对于一个用户的所有成交，这个ID都是不重复的\n\n  this.exchange_id = ''; // 'SHFE' 交易所\n\n  this.instrument_id = ''; // 'rb1901' 交易所内的合约代码\n\n  this.exchange_trade_id = ''; // 交易所成交单号\n\n  this.direction = ''; // 下单方向 (BUY=买, SELL=卖)\n\n  this.offset = ''; // 开平标志 (OPEN=开仓, CLOSE=平仓, CLOSETODAY=平今)\n\n  this.volume = 0; // 成交手数\n\n  this.price = 0; // 成交价格\n\n  this.trade_date_time = 0; // 成交时间, epoch nano\n\n  this.commission = 0; // 成交手续费\n\n  this.seqno = 0;\n};\n\nvar ORDER = function ORDER() {\n  _classCallCheck(this, ORDER);\n\n  // order_id, 用于唯一标识一个委托单. 对于一个USER, order_id 是永远不重复的\n  // 委托单初始属性 (由下单者在下单前确定, 不再改变)\n  this.user_id = ''; // 用户ID\n\n  this.order_id = ''; // 委托单ID, 对于一个USER, order_id 是永远不重复的\n\n  this.exchange_id = ''; // 交易所\n\n  this.instrument_id = ''; // 在交易所中的合约代码\n\n  this.direction = ''; // 下单方向 (BUY=买, SELL=卖)\n\n  this.offset = ''; // 开平标志 (OPEN=开仓, CLOSE=平仓, CLOSETODAY=平今)\n\n  this.volume_orign = 0; // 总报单手数\n\n  this.price_type = ''; // 指令类型 (ANY=市价, LIMIT=限价)\n\n  this.limit_price = 0; // 委托价格, 仅当 price_type = LIMIT 时有效\n\n  this.time_condition = ''; // 时间条件 (IOC=立即完成，否则撤销, GFS=本节有效, *GFD=当日有效, GTC=撤销前有效, GFA=集合竞价有效)\n\n  this.volume_condition = ''; // 数量条件 (ANY=任何数量, MIN=最小数量, ALL=全部数量)\n\n  this. //  =单后获得的信息;由期货公司返回, 不会改变)\n  this.insert_date_time = 0; // 1501074872000000000 下单时间(按北京时间)，自unix epoch(1970-01-01 00:00:00 GMT)以来的纳秒数\n\n  this.exchange_order_id = ''; // 交易所单号\n\n  this. //  =托单当前状态;this.status = ''; // 委托单状态, (ALIVE=有效, FINISHED=已完)\n  this.volume_left = 0; // 未成交手数\n\n  this.frozen_margin = 0; // 冻结保证金\n\n  this.last_msg = ''; // \"报单成功\" 委托单状态信息\n\n  this.seqno = 0; // 部序号\n};\n\nvar POSITION = function POSITION() {\n  _classCallCheck(this, POSITION);\n\n  // 交易所和合约代码\n  this.user_id = ''; // 用户ID\n\n  this.exchange_id = ''; // 'SHFE' 交易所\n\n  this.instrument_id = ''; // 'rb1901' 交易所内的合约代码\n  // 持仓手数与冻结手数\n\n  this.volume_long_today = 0; // 多头今仓持仓手数\n\n  this.volume_long_his = 0; // 多头老仓持仓手数\n\n  this.volume_long = 0; // 多头持仓手数\n\n  this.volume_long_frozen_today = 0; // 多头今仓冻结手数\n\n  this.volume_long_frozen_his = 0; // 多头老仓冻结手数\n\n  this.volume_long_frozen = 0; // 多头持仓冻结\n\n  this.volume_short_today = 0; // 空头今仓持仓手数\n\n  this.volume_short_his = 0; // 空头老仓持仓手数\n\n  this.volume_short = 0; // 空头持仓手数\n\n  this.volume_short_frozen_today = 0; // 空头今仓冻结手数\n\n  this.volume_short_frozen_his = 0; // 空头老仓冻结手数\n\n  this.volume_short_frozen = 0; // 空头持仓冻结\n  // 成本, 现价与盈亏\n\n  this.open_price_long = 0; // 多头开仓均价\n\n  this.open_price_short = 0; // 空头开仓均价\n\n  this.open_cost_long = 0; // 多头开仓市值\n\n  this.open_cost_short = 0; // 空头开仓市值\n\n  this.position_price_long = 0; // 多头持仓均价\n\n  this.position_price_short = 0; // 空头持仓均价\n\n  this.position_cost_long = 0; // 多头持仓市值\n\n  this.position_cost_short = 0; // 空头持仓市值\n\n  this.last_price = 0; // 最新价\n\n  this.float_profit_long = 0; // 多头浮动盈亏\n\n  this.float_profit_short = 0; // 空头浮动盈亏\n\n  this.float_profit = 0; // 浮动盈亏 = float_profit_long + float_profit_short\n\n  this.position_profit_long = 0; // 多头持仓盈亏\n\n  this.position_profit_short = 0; // 空头持仓盈亏\n\n  this.position_profit = 0; // 持仓盈亏 = position_profit_long + position_profit_short\n  // 保证金占用\n\n  this.margin_long = 0; // 多头持仓占用保证金\n\n  this.margin_short = 0; // 空头持仓占用保证金\n\n  this.margin = 0; // 持仓占用保证金 = margin_long + margin_short\n};\n\nvar BANK = function BANK() {\n  _classCallCheck(this, BANK);\n\n  this.id = '';\n  this.name = '';\n};\n\nvar ACCOUNT = function ACCOUNT() {\n  _classCallCheck(this, ACCOUNT);\n\n  this.currency = ''; // \"CNY\" (币种)\n\n  this.balance = NaN; // 账户权益\n\n  this.available = NaN; // 可用资金\n\n  this.pre_balance = NaN; // 昨日账户权益\n\n  this.deposit = NaN; // 入金金额 本交易日内的入金金额\n\n  this.withdraw = NaN; // 出金金额 本交易日内的出金金额\n\n  this.commission = NaN; // 手续费 本交易日内交纳的手续费\n\n  this.premium = NaN; // 权利金 本交易日内交纳的权利金\n\n  this.static_balance = NaN; // 静态权益\n\n  this.position_profit = NaN; // 持仓盈亏\n\n  this.float_profit = NaN; // 浮动盈亏\n\n  this.risk_ratio = NaN; // 风险度\n\n  this.margin = NaN; // 保证金占用\n\n  this.frozen_margin = NaN; // 冻结保证金\n\n  this.frozen_commission = NaN; // 冻结手续费\n\n  this.frozen_premium = NaN; // 冻结权利金\n\n  this.close_profit = NaN; // 本交易日内平仓盈亏\n};\n\nvar DataStructure = {\n  QUOTE: QUOTE,\n  KLINE: KLINE,\n  TICK: TICK,\n  TRADE: TRADE,\n  ORDER: ORDER,\n  POSITION: POSITION,\n  BANK: BANK,\n  ACCOUNT: ACCOUNT\n};\n\nvar GenPrototype = function GenPrototype(k) {\n  return new DataStructure[k.toUpperCase()]();\n};\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (GenPrototype);\n\n//# sourceURL=webpack://TQSDK/./src/datastructure.js?");

/***/ }),

/***/ "./src/event.js":
/*!**********************!*\
  !*** ./src/event.js ***!
  \**********************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return EventPrototype; });\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nvar EventPrototype =\n/*#__PURE__*/\nfunction () {\n  function EventPrototype() {\n    _classCallCheck(this, EventPrototype);\n\n    this.handlers = {};\n  }\n\n  _createClass(EventPrototype, [{\n    key: \"once\",\n    value: function once(eventType, handler) {\n      (this.handlers[eventType] || (this.handlers[eventType] = [])).push({\n        once: true,\n        func: handler\n      });\n    }\n  }, {\n    key: \"addEventListener\",\n    value: function addEventListener(eventType, handler) {\n      (this.handlers[eventType] || (this.handlers[eventType] = [])).push({\n        once: false,\n        func: handler\n      });\n    }\n  }, {\n    key: \"removeEventListener\",\n    value: function removeEventListener(eventType, handler) {\n      if (!Array.isArray(this.handlers[eventType])) return;\n      var handlers = this.handlers[eventType];\n\n      for (var i = 0; i < handlers.length; i++) {\n        if (handlers[i]['func'] === handler) {\n          this.handlers[eventType].splice(i, 1);\n          break;\n        }\n      }\n\n      if (this.handlers[eventType].length === 0) {\n        delete this.handlers[eventType];\n      }\n    }\n  }, {\n    key: \"fire\",\n    value: function fire(eventType, payload) {\n      if (!Array.isArray(this.handlers[eventType])) return;\n      var handlers = this.handlers[eventType].slice();\n\n      for (var i = 0; i < handlers.length; i++) {\n        handlers[i]['func'].call(this, payload);\n\n        if (handlers[i]['once']) {\n          this.removeEventListener(eventType, handlers[i]['func']);\n        }\n      }\n    }\n  }]);\n\n  return EventPrototype;\n}();\n\n\n\n//# sourceURL=webpack://TQSDK/./src/event.js?");

/***/ }),

/***/ "./src/index.js":
/*!**********************!*\
  !*** ./src/index.js ***!
  \**********************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* WEBPACK VAR INJECTION */(function(setImmediate) {/* harmony import */ var _tqwebsocket__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./tqwebsocket */ \"./src/tqwebsocket.js\");\n/* harmony import */ var _datamanage__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./datamanage */ \"./src/datamanage.js\");\n/* harmony import */ var _event__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./event */ \"./src/event.js\");\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./utils */ \"./src/utils.js\");\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\n\n\n\n\n/**\n * 事件类型\n + ready: 收到合约基础数据（全局只出发一次）\n + rtn_brokers: 收到期货公司列表\n + notify: 收到通知对象\n + rtn_data: 数据更新（每一次数据更新触发）\n + error: 发生错误(目前只有一种：合约服务下载失败)\n */\n\nvar TQSDK =\n/*#__PURE__*/\nfunction (_EventPrototype) {\n  _inherits(TQSDK, _EventPrototype);\n\n  function TQSDK() {\n    var _this;\n\n    var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n        _ref$symbolsServerUrl = _ref.symbolsServerUrl,\n        symbolsServerUrl = _ref$symbolsServerUrl === void 0 ? 'https://openmd.shinnytech.com/t/md/symbols/latest.json' : _ref$symbolsServerUrl,\n        _ref$wsQuoteUrl = _ref.wsQuoteUrl,\n        wsQuoteUrl = _ref$wsQuoteUrl === void 0 ? 'wss://openmd.shinnytech.com/t/md/front/mobile' : _ref$wsQuoteUrl,\n        _ref$wsTradeUrl = _ref.wsTradeUrl,\n        wsTradeUrl = _ref$wsTradeUrl === void 0 ? 'wss://t.shinnytech.com/trade/shinny' : _ref$wsTradeUrl,\n        _ref$reconnectInterva = _ref.reconnectInterval,\n        reconnectInterval = _ref$reconnectInterva === void 0 ? 3000 : _ref$reconnectInterva,\n        _ref$reconnectMaxTime = _ref.reconnectMaxTimes,\n        reconnectMaxTimes = _ref$reconnectMaxTime === void 0 ? 5 : _ref$reconnectMaxTime,\n        _ref$prefix = _ref.prefix,\n        prefix = _ref$prefix === void 0 ? '' : _ref$prefix,\n        _ref$needsQuotesServi = _ref.needsQuotesService,\n        needsQuotesService = _ref$needsQuotesServi === void 0 ? true : _ref$needsQuotesServi;\n\n    _classCallCheck(this, TQSDK);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(TQSDK).call(this));\n    _this.version = \"1.0.12\";\n    _this._symbol_services_url = symbolsServerUrl;\n    _this._prefix = 'TQJS_' + (prefix ? prefix + '_' : '');\n    _this.brokers = null;\n    _this.login_user_id = ''; // 用户填写的登录 user_id\n\n    _this.login_bid = '';\n    _this.login_password = ''; // 合约服务已经准备就绪\n\n    _this.isQuotesInfoReady = needsQuotesService ? false : true; // 全部合约信息\n\n    _this.quotesInfo = {};\n\n    _this._initQuotesInfo();\n\n    _this.dm = new _datamanage__WEBPACK_IMPORTED_MODULE_1__[\"default\"]();\n    var options = {\n      reconnectInterval: reconnectInterval,\n      reconnectMaxTimes: reconnectMaxTimes\n    };\n    _this.quotesWs = new _tqwebsocket__WEBPACK_IMPORTED_MODULE_0__[\"default\"](wsQuoteUrl, options);\n\n    if (wsTradeUrl === '' || wsTradeUrl === wsQuoteUrl) {\n      _this.tradeWs = _this.quotesWs;\n    } else {\n      _this.tradeWs = new _tqwebsocket__WEBPACK_IMPORTED_MODULE_0__[\"default\"](wsTradeUrl, options);\n    }\n\n    _this._initWebsocketsCb();\n\n    return _this;\n  }\n\n  _createClass(TQSDK, [{\n    key: \"_initQuotesInfo\",\n    value: function _initQuotesInfo() {\n      if (!this.isQuotesInfoReady) {\n        this.isQuotesInfoReady = false;\n        var tqsdk_this = this;\n        this.quotesInfoPromise = fetch(this._symbol_services_url, {\n          headers: {\n            Accept: 'application/json; charset=utf-8'\n          }\n        }).then(function (response) {\n          return response.json();\n        }).then(function (data) {\n          tqsdk_this.quotesInfo = data;\n          tqsdk_this.isQuotesInfoReady = true;\n          return Promise.resolve(data);\n        }).then(function () {\n          tqsdk_this.fire('ready');\n        }).catch(function (error) {\n          tqsdk_this.fire('error', error);\n          return Promise.reject('Error: ' + error.message);\n        });\n      }\n    }\n  }, {\n    key: \"_separateNotifies\",\n    value: function _separateNotifies(data) {\n      var notifies = [];\n\n      for (var i = 0; i < data.length; i++) {\n        if (data[i]['notify']) {\n          var notify = data.splice(i--, 1)[0]['notify'];\n\n          for (var k in notify) {\n            notifies.push(notify[k]);\n          }\n        }\n      }\n\n      return notifies;\n    }\n  }, {\n    key: \"on\",\n    value: function on(eventName, fn) {\n      if (eventName === 'ready') {\n        if (this.isQuotesInfoReady) fn.call(this);else this.once(eventName, fn);\n      } else if (eventName === 'rtn_brokers') {\n        if (this.brokers) fn.call(this, this.brokers);else this.once(eventName, fn);\n      } else if (eventName === 'rtn_data' && this.dm.isChanging('/')) {\n        fn.call(this);\n        this.addEventListener(eventName, fn);\n      } else {\n        this.addEventListener(eventName, fn);\n      }\n    }\n  }, {\n    key: \"off\",\n    value: function off(eventName, fn) {\n      this.removeEventListener(eventName, fn);\n    }\n  }, {\n    key: \"_initWebsocketsCb\",\n    value: function _initWebsocketsCb() {\n      var tqsdk_this = this;\n      this.dm.addEventListener('data', function () {\n        tqsdk_this.fire('rtn_data', null);\n      });\n      this.tradeWs.addEventListener('message', function (payload) {\n        if (payload.aid === 'rtn_brokers') {\n          tqsdk_this.brokers = payload.brokers;\n          tqsdk_this.fire('rtn_brokers', payload.brokers);\n        } else if (payload.aid === 'rtn_data') {\n          var notifies = tqsdk_this._separateNotifies(payload.data);\n\n          for (var i = 0; i < notifies.length; i++) {\n            tqsdk_this.fire('notify', notifies[i]);\n          }\n\n          tqsdk_this.dm.mergeData(payload.data);\n        }\n\n        setImmediate(function () {\n          tqsdk_this.tradeWs.send('{\"aid\":\"peek_message\"}');\n        });\n      });\n      this.tradeWs.addEventListener('reconnect', function () {\n        if (tqsdk_this.is_logined()) {\n          tqsdk_this.login({\n            bid: tqsdk_this.login_bid,\n            user_id: tqsdk_this.login_user_id,\n            password: tqsdk_this.login_password\n          });\n        }\n      });\n      this.quotesWs.addEventListener('message', function (payload) {\n        if (payload.aid === 'rtn_data') {\n          tqsdk_this.dm.mergeData(payload.data);\n        }\n\n        setImmediate(function () {\n          tqsdk_this.quotesWs.send('{\"aid\":\"peek_message\"}');\n        });\n      });\n      this.tradeWs.addEventListener('reconnect', function () {\n        if (tqsdk_this.dm._data.ins_list) {\n          tqsdk_this.subscribe_quote(tqsdk_this.dm._data.ins_list);\n        }\n      });\n    }\n  }, {\n    key: \"update_data\",\n    value: function update_data(data) {\n      this.dm.mergeData(data, true, false);\n    }\n  }, {\n    key: \"get_by_path\",\n    value: function get_by_path(_path) {\n      return this.dm._getByPath(_path);\n    }\n  }, {\n    key: \"get_quotes_by_input\",\n    value: function get_quotes_by_input(_input) {\n      if (typeof _input !== 'string' && !_input.input) return [];\n      var option = {\n        input: typeof _input === 'string' ? _input.toLowerCase() : _input.input.toLowerCase(),\n        instrument_id: _input.instrument_id ? _input.instrument_id : true,\n        // 是否根据合约ID匹配\n        pinyin: _input.pinyin ? _input.pinyin : true,\n        // 是否根据拼音匹配\n        include_expired: _input.include_expired ? _input.include_expired : false,\n        // 匹配结果是否包含已下市合约\n        FUTURE: _input.future ? !!_input.future : true,\n        // 匹配结果是否包含期货合约\n        FUTURE_INDEX: _input.future_index ? !!_input.future_index : false,\n        // 匹配结果是否包含期货指数\n        FUTURE_CONT: _input.future_cont ? !!_input.future_cont : false,\n        // 匹配结果是否包含期货主连\n        OPTION: _input.option ? !!_input.option : false,\n        // 匹配结果是否包含期权\n        COMBINE: _input.combine ? !!_input.combine : false // 匹配结果是否包含组合\n\n      };\n\n      var filterSymbol = function filterSymbol(filterOption, quote, by) {\n        if (filterOption[quote.class] && (filterOption.include_expired || !filterOption.include_expired && !quote.expired)) {\n          if (by === 'instrument_id') {\n            if (quote.product_id.toLowerCase() === filterOption.input) {\n              return true;\n            } else if (filterOption.input.length > 2 && quote.instrument_id.toLowerCase().indexOf(filterOption.input) > -1) {\n              return true;\n            } else {\n              return false;\n            }\n          } else if (by === 'pinyin' && quote.py.split(',').indexOf(filterOption.input) > -1) {\n            return true;\n          } else {\n            return false;\n          }\n        }\n\n        return false;\n      };\n\n      var result = [];\n\n      if (option.instrument_id) {\n        for (var symbol in this.quotesInfo) {\n          if (filterSymbol(option, this.quotesInfo[symbol], 'instrument_id')) {\n            result.push(symbol);\n          }\n        }\n      }\n\n      if (option.pinyin) {\n        for (var _symbol in this.quotesInfo) {\n          if (filterSymbol(option, this.quotesInfo[_symbol], 'pinyin')) {\n            result.push(_symbol);\n          }\n        }\n      }\n\n      return result;\n    }\n  }, {\n    key: \"get_quote\",\n    value: function get_quote(symbol) {\n      if (symbol === '') return {};\n      var symbolObj = this.dm.setDefault('quote', 'quotes', symbol);\n\n      if (!symbolObj['class'] && this.quotesInfo[symbol]) {\n        // quotesInfo 中的 last_price\n        var last_price = symbolObj.last_price ? symbolObj.last_price : this.quotesInfo[symbol].last_price;\n        Object.assign(symbolObj, this.quotesInfo[symbol], {\n          last_price: last_price\n        });\n      }\n\n      return symbolObj;\n    }\n  }, {\n    key: \"get_account_id\",\n    value: function get_account_id() {\n      return this.login_user_id;\n    }\n  }, {\n    key: \"get_positions\",\n    value: function get_positions() {\n      if (this.is_logined()) {\n        return this.dm.setDefault({}, 'trade', this.login_user_id, 'positions');\n      } else {\n        return null;\n      }\n    }\n  }, {\n    key: \"get_trades\",\n    value: function get_trades() {\n      if (this.is_logined()) {\n        return this.dm.setDefault({}, 'trade', this.login_user_id, 'trades');\n      } else {\n        return null;\n      }\n    }\n  }, {\n    key: \"get_position\",\n    value: function get_position(symbol) {\n      if (this.is_logined()) {\n        return this.dm.setDefault('position', 'trade', this.login_user_id, 'positions', symbol);\n      } else {\n        return null;\n      }\n    }\n  }, {\n    key: \"get_orders\",\n    value: function get_orders() {\n      if (this.is_logined()) {\n        return this.dm.setDefault({}, 'trade', this.login_user_id, 'orders');\n      } else {\n        return null;\n      }\n    }\n  }, {\n    key: \"get_order\",\n    value: function get_order(order_id) {\n      if (this.is_logined()) {\n        return this.dm.setDefault('order', 'trade', this.login_user_id, 'orders', order_id);\n      } else {\n        return null;\n      }\n    }\n  }, {\n    key: \"get_accounts\",\n    value: function get_accounts() {\n      if (this.is_logined()) {\n        return this.dm.setDefault('account', 'trade', this.login_user_id, 'accounts');\n      } else {\n        return null;\n      }\n    }\n  }, {\n    key: \"get_account\",\n    value: function get_account() {\n      var user_id = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.login_user_id;\n      var currency = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'CNY';\n\n      if (this.is_logined()) {\n        return this.dm.setDefault('account', 'trade', this.login_user_id, 'accounts', currency);\n      } else {\n        return null;\n      }\n    } // 通过 trading_day 可以确定登录成功\n\n  }, {\n    key: \"get_trading_day\",\n    value: function get_trading_day() {\n      if (this.login_user_id) {\n        var d = this.get_by_path(['trade', this.login_user_id, 'session', 'trading_day']);\n        return d && typeof d === \"string\" ? d : '';\n      }\n\n      return '';\n    }\n  }, {\n    key: \"get_klines\",\n    value: function get_klines(symbol, duration) {\n      return this.dm.getKlines(symbol, duration);\n    }\n  }, {\n    key: \"get_ticks\",\n    value: function get_ticks(symbol) {\n      return this.dm.getTicks(symbol);\n    }\n  }, {\n    key: \"is_logined\",\n    value: function is_logined() {\n      return !!(this.login_user_id && this.get_trading_day());\n    }\n  }, {\n    key: \"is_changed\",\n    value: function is_changed(target, source) {\n      if (target._epoch) return target._epoch === this.dm._epoch;\n      if (typeof target === 'string') return this.dm.isChanging(target, source);\n      return false;\n    }\n  }, {\n    key: \"insert_order\",\n    value: function insert_order(payload) {\n      if (!this.is_logined()) return null;\n      var order_id = this._prefix + Object(_utils__WEBPACK_IMPORTED_MODULE_3__[\"RandomStr\"])(8);\n      var _order_common = {\n        user_id: this.login_user_id,\n        order_id: order_id,\n        exchange_id: payload.exchange_id,\n        instrument_id: payload.ins_id,\n        direction: payload.direction,\n        offset: payload.offset,\n        price_type: payload.price_type ? payload.price_type : \"LIMIT\",\n        // \"LIMIT\" \"ANY\"\n        limit_price: Number(payload.limit_price),\n        volume_condition: \"ANY\",\n        // 数量条件 (ANY=任何数量, MIN=最小数量, ALL=全部数量)\n        time_condition: payload.price_type === 'ANY' ? 'IOC' : 'GFD' // 时间条件 (IOC=立即完成，否则撤销, GFS=本节有效, *GFD=当日有效, GTC=撤销前有效, GFA=集合竞价有效)\n\n      };\n\n      var _order_insert = Object.assign({\n        aid: 'insert_order',\n        volume: payload.volume\n      }, _order_common);\n\n      this.tradeWs.send(_order_insert);\n\n      var _order_init = Object.assign({\n        volume_orign: payload.volume,\n        // 总报单手数\n        // 委托单当前状态\n        status: 'ALIVE',\n        // 委托单状态, (ALIVE=有效, FINISHED=已完)\n        volume_left: payload.volume // 未成交手数\n\n      }, _order_common);\n\n      this.dm.mergeData({\n        'trade': _defineProperty({}, this.login_user_id, {\n          orders: _defineProperty({}, order_id, _order_init)\n        })\n      }, false, false);\n      return this.get_order(order_id);\n    }\n  }, {\n    key: \"auto_insert_order\",\n    value: function auto_insert_order(payload) {\n      if (!this.is_logined()) return null;\n      /* payload : {symbol, exchange_id, ins_id, direction, price_type, limit_price, offset, volume} */\n\n      var initOrder = {\n        price_type: payload.price_type ? payload.price_type : \"LIMIT\",\n        // \"LIMIT\" \"ANY\"\n        volume_condition: \"ANY\",\n        time_condition: payload.price_type === 'ANY' ? 'IOC' : 'GFD',\n        exchange_id: payload.exchange_id,\n        instrument_id: payload.ins_id,\n        direction: payload.direction,\n        limit_price: Number(payload.limit_price)\n      };\n\n      if (payload.exchange_id === 'SHFE' && payload.offset === 'CLOSE') {\n        var position = this.dm.getPosition(payload.symbol, this.login_user_id); // 拆单，先平今再平昨\n\n        var closeTodayVolume = 0;\n\n        if (payload.direction === 'BUY' && position.volume_short_today > 0) {\n          closeTodayVolume = Math.min(position.volume_short_today, payload.volume);\n        } else if (payload.direction === 'SELL' && position.volume_long_today > 0) {\n          closeTodayVolume = Math.min(position.volume_long_today, payload.volume);\n        }\n\n        if (closeTodayVolume > 0) {\n          this.insert_order(Object.assign({\n            offset: 'CLOSETODAY',\n            volume: closeTodayVolume\n          }, initOrder));\n        }\n\n        if (payload.volume - closeTodayVolume > 0) {\n          this.insert_order(Object.assign({\n            offset: 'CLOSE',\n            volume: payload.volume - closeTodayVolume\n          }, initOrder));\n        }\n      } else {\n        this.insert_order(Object.assign({\n          offset: payload.offset,\n          volume: payload.volume\n        }, initOrder));\n      }\n    }\n  }, {\n    key: \"cancel_order\",\n    value: function cancel_order(payload) {\n      this.tradeWs.send({\n        aid: 'cancel_order',\n        user_id: this.login_user_id,\n        order_id: payload.order_id ? payload.order_id : payload\n      });\n    } // 登录\n\n  }, {\n    key: \"login\",\n    value: function login(payload) {\n      this.login_bid = payload.bid, this.login_user_id = payload.user_id;\n      this.login_password = payload.password;\n      this.tradeWs.send({\n        aid: 'req_login',\n        bid: payload.bid,\n        user_name: payload.user_id,\n        password: payload.password\n      });\n    } // 确认结算单\n\n  }, {\n    key: \"confirm_settlement\",\n    value: function confirm_settlement() {\n      this.tradeWs.send({\n        aid: 'confirm_settlement'\n      });\n    } // 银期转账\n\n  }, {\n    key: \"transfer\",\n    value: function transfer(payload) {\n      this.tradeWs.send({\n        aid: 'req_transfer',\n        bank_id: payload.bank_id,\n        // 银行ID\n        bank_password: payload.bank_password,\n        // 银行账户密码\n        future_account: payload.future_account,\n        // 期货账户\n        future_password: payload.future_password,\n        // 期货账户密码\n        currency: 'CNY',\n        // 币种代码\n        amount: payload.amount // 转账金额, >0 表示转入期货账户, <0 表示转出期货账户\n\n      });\n    }\n  }, {\n    key: \"subscribe_quote\",\n    value: function subscribe_quote(quotes) {\n      this.quotesWs.send({\n        aid: \"subscribe_quote\",\n        ins_list: Array.isArray(quotes) ? quotes.join(',') : quotes\n      });\n    }\n  }, {\n    key: \"set_chart\",\n    value: function set_chart(payload) {\n      var content = {};\n\n      if (payload.trading_day_start || payload.trading_day_count) {\n        // 指定交易日，返回对应的数据\n        content.trading_day_start = payload.trading_day_start ? payload.trading_day_start : 0; // trading_day_count 请求交易日天数\n\n        content.trading_day_count = payload.trading_day_count ? payload.trading_day_count : 3600 * 24 * 1e9;\n      } else {\n        content.view_width = payload.view_width ? payload.view_width : 500;\n\n        if (payload.left_kline_id) {\n          // 指定一个K线id，向右请求N个数据\n          content.left_kline_id = payload.left_kline_id;\n        } else if (payload.focus_datetime) {\n          // 使得指定日期的K线位于屏幕第M个柱子的位置\n          content.focus_datetime = payload.focus_datetime; // 日线及以上周期是交易日，其他周期是时间，UnixNano 北京时间\n\n          content.focus_position = payload.focus_position ? payload.focus_position : 0;\n        }\n      }\n\n      this.quotesWs.send(Object.assign({\n        aid: 'set_chart',\n        chart_id: payload.chart_id ? payload.chart_id : this._prefix + 'kline_chart',\n        ins_list: payload.ins_list ? payload.ins_list.join(',') : payload.symbol,\n        duration: payload.duration\n      }, content));\n    }\n  }]);\n\n  return TQSDK;\n}(_event__WEBPACK_IMPORTED_MODULE_2__[\"default\"]);\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (TQSDK);\n/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../node_modules/timers-browserify/main.js */ \"./node_modules/timers-browserify/main.js\").setImmediate))\n\n//# sourceURL=webpack://TQSDK/./src/index.js?");

/***/ }),

/***/ "./src/tqwebsocket.js":
/*!****************************!*\
  !*** ./src/tqwebsocket.js ***!
  \****************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return TqWebsocket; });\n/* harmony import */ var _event__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./event */ \"./src/event.js\");\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\n/* eslint-disable no-eval */\n\n/**\n * let ws = new TqWebsocket(url, options)\n * PARAMS:\n *   url [string | array]\n *   options [object]\n *       { reconnectInterval, -- 重连时间间隔\n  *        reconnectMaxTimes  -- 重连最大次数\n *       }\n *\n * METHODS:\n *   ws.init()\n *   ws.addEventListener('message', (data) => {......})\n *      eventTypes =\n *      ['message', -- 收到信息\n *       'open', -- 连接建立\n *       'reconnect', -- 重新开始建立连接\n *       'close', -- 某个连接关闭\n *       'error', -- 某个连接报错\n *       'death' -- 不再重连\n *      ]\n *   ws.send( [obj | string] )\n */\n\nvar TqWebsocket =\n/*#__PURE__*/\nfunction (_EventPrototype) {\n  _inherits(TqWebsocket, _EventPrototype);\n\n  function TqWebsocket(url) {\n    var _this2;\n\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    _classCallCheck(this, TqWebsocket);\n\n    _this2 = _possibleConstructorReturn(this, _getPrototypeOf(TqWebsocket).call(this));\n\n    if (url instanceof Array) {\n      _this2.urlList = url;\n    } else {\n      _this2.urlList = [url];\n    }\n\n    _this2.ws = null;\n    _this2.queue = []; // 自动重连开关\n\n    _this2.reconnect = true;\n    _this2.reconnectTask = null;\n    _this2.reconnectInterval = options.reconnectInterval ? options.reconnectInterval : 3000;\n    _this2.reconnectMaxTimes = options.reconnectMaxTimes ? options.reconnectMaxTimes : 5;\n    _this2.reconnectTimes = 0;\n    _this2.reconnectUrlIndex = 0;\n    _this2.STATUS = {\n      CONNECTING: 0,\n      OPEN: 1,\n      CLOSING: 2,\n      CLOSED: 3\n    };\n\n    _this2.init();\n\n    return _this2;\n  } // string or object\n\n\n  _createClass(TqWebsocket, [{\n    key: \"send\",\n    value: function send(obj) {\n      var objToJson = typeof obj === 'string' ? obj : JSON.stringify(obj);\n\n      if (this.isReady()) {\n        this.ws.send(objToJson);\n      } else {\n        this.queue.push(objToJson);\n      }\n    }\n  }, {\n    key: \"isReady\",\n    value: function isReady() {\n      return this.ws.readyState === this.STATUS.OPEN;\n    }\n  }, {\n    key: \"init\",\n    value: function init() {\n      this.ws = new WebSocket(this.urlList[this.reconnectUrlIndex]);\n\n      if (this.reconnectUrlIndex === this.urlList.length - 1) {\n        // urlList 循环尝试重连一轮, times += 1\n        this.reconnectTimes += 1;\n      }\n\n      var _this = this;\n\n      this.ws.onmessage = function (message) {\n        var data = eval('(' + message.data + ')');\n\n        _this.fire('message', data); // _this.ws.send('{\"aid\":\"peek_message\"}')\n\n      };\n\n      this.ws.onclose = function (event) {\n        console.log('close', event);\n\n        _this.fire('close'); // 清空 queue\n\n\n        _this.queue = []; // 自动重连\n\n        if (_this.reconnect) {\n          if (_this.reconnectMaxTimes <= _this.reconnectTimes) {\n            _this.fire('death');\n          } else {\n            _this.reconnectTask = setInterval(function () {\n              if (_this.ws.readyState === 3) {\n                // 每次重连的时候设置 _this.reconnectUrlIndex\n                _this.reconnectUrlIndex = _this.reconnectUrlIndex + 1 < _this.urlList.length ? _this.reconnectUrlIndex + 1 : 0;\n\n                _this.init();\n\n                _this.fire('reconnect');\n              }\n            }, _this.reconnectInterval);\n          }\n        }\n      };\n\n      this.ws.onerror = function (error) {\n        console.error(error);\n\n        _this.fire('error', error);\n\n        _this.ws.close();\n      };\n\n      this.ws.onopen = function () {\n        _this.reconnectTimes = 0;\n        _this.reconnectUrlIndex = 0;\n\n        _this.fire('open');\n\n        if (this.reconnectTask) {\n          clearInterval(_this.reconnectTask);\n        }\n\n        while (_this.queue.length > 0) {\n          if (_this.ws.readyState === 1) _this.ws.send(_this.queue.shift());else break;\n        }\n      };\n    }\n  }]);\n\n  return TqWebsocket;\n}(_event__WEBPACK_IMPORTED_MODULE_0__[\"default\"]);\n\n\n\n//# sourceURL=webpack://TQSDK/./src/tqwebsocket.js?");

/***/ }),

/***/ "./src/utils.js":
/*!**********************!*\
  !*** ./src/utils.js ***!
  \**********************/
/*! exports provided: UnifyArrayStyle, IsEmptyObject, RandomStr */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"UnifyArrayStyle\", function() { return UnifyArrayStyle; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"IsEmptyObject\", function() { return IsEmptyObject; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"RandomStr\", function() { return RandomStr; });\nvar UnifyArrayStyle = function UnifyArrayStyle(path) {\n  var splitSymbol = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '/';\n  if (!Array.isArray(path)) path = path.split(splitSymbol);\n  return path.filter(function (x) {\n    return x !== '';\n  });\n};\n\nvar IsEmptyObject = function IsEmptyObject(obj) {\n  return Object.keys(obj).length === 0 ? true : false;\n};\n\nvar RandomStr = function RandomStr() {\n  var len = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 8;\n  var charts = \"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\".split('');\n  var s = '';\n\n  for (var i = 0; i < len; i++) {\n    s += charts[Math.random() * 0x3e | 0];\n  }\n\n  return s;\n};\n\n\n\n//# sourceURL=webpack://TQSDK/./src/utils.js?");

/***/ })

/******/ })["default"];
});